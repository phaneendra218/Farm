{% extends "base.html" %}

{% block content %}
<h2>Items</h2>

<!-- Check if there are any items to display -->
{% if items %}
    <div class="item-container">
        {% for item in items %}
            <div class="item-card">
                <h4>{{ item.name }}</h4>
                <p>Price: â‚¹{{ item.price }}</p>
                
                <!-- Display image if it exists -->
                {% if item.image_path %}
                    <img src="{{ url_for('static', filename='uploads/' + item.image_path.split('/')[-1]) }}" alt="{{ item.name }}" style="width:150px; height:100px;">
                {% else %}
                    <p>No image available</p>
                {% endif %}

                <!-- Display 'Sold Out' for hidden items -->
                {% if item.is_hidden %}
                    <p class="text-danger" style="font-weight: bold; margin-top:10px;">Sold Out</p>
                {% else %}
                    <!-- Quantity input for adding to basket -->
                    <form method="POST" action="{{ url_for('add_to_basket', item_id=item.id) }}" style="margin-top:10px;">
                        <label for="quantity_{{ item.id }}">Quantity:</label>
                        <input type="number" name="quantity" id="quantity_{{ item.id }}" min="1" value="1" required>
                        <button type="submit" class="btn btn-success">Add to Basket</button>
                    </form>
                    
                    <!-- Order item button -->
                    <form method="POST" action="{{ url_for('order_item', item_id=item.id) }}" style="margin-top:10px;">
                        <input type="hidden" name="item_id" value="{{ item.id }}">
                        <button type="submit" class="btn btn-primary">Order</button>
                    </form>
                {% endif %}

                <!-- Admin actions -->
                {% if session.get('is_admin') %}
                    <!-- Update button -->
                    <form action="{{ url_for('update_item', item_id=item.id) }}" method="get" style="display:inline;">
                        <button type="submit" class="btn btn-primary" style="margin-top:10px;">Update</button>
                    </form> 

                    <!-- Delete button -->
                    <form method="POST" action="{{ url_for('delete_item', item_id=item.id) }}" style="margin-top:10px;">
                        <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this item?');">Delete</button>
                    </form>
                    
                    <!-- Hide/Unhide button -->
                    {% if item.is_hidden %}
                        <form method="POST" action="{{ url_for('unhide_item', item_id=item.id) }}" style="margin-top:10px;">
                            <button type="submit" class="btn btn-warning">Unhide</button>
                        </form>
                    {% else %}
                        <form method="POST" action="{{ url_for('hide_item', item_id=item.id) }}" style="margin-top:10px;">
                            <button type="submit" class="btn btn-danger">Hide</button>
                        </form>
                    {% endif %}
                {% endif %}
            </div>
        {% endfor %}
    </div>
{% else %}
    <p>No items available at the moment.</p>
{% endif %}
{% endblock %}
